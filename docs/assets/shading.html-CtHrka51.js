import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as n,a as t,o as l}from"./app-BBClClBQ.js";const p="/assets/image-BrFCxsa_.png",e="/assets/image-1-BhtD3EUO.png",i="/assets/image-2-CnWkw5dy.png",m={};function r(c,s){return l(),n("div",null,s[0]||(s[0]=[t('<h2 id="栅格化" tabindex="-1"><a class="header-anchor" href="#栅格化"><span>栅格化</span></a></h2><p>在游戏开发中，栅格化是图形渲染管线的一个核心部分，特别是在将3D世界中的几何数据转换为2D屏幕图像时。栅格化过程通常发生在渲染管线的后期，主要负责将由3D模型、纹理和光照计算得到的场景信息转化为2D图像。</p><h3 id="游戏中的栅格化过程" tabindex="-1"><a class="header-anchor" href="#游戏中的栅格化过程"><span>游戏中的栅格化过程</span></a></h3><p>在游戏中，栅格化涉及多个关键步骤，通常包括以下几个阶段：</p><ol><li><p><strong>几何处理（Geometry Processing）</strong>：</p><ul><li>游戏中的三维模型（如人物、建筑、道具等）通过顶点坐标、法线、纹理坐标等信息进行处理。</li><li>每个模型的顶点在3D空间中被转换到相机视角（视图矩阵）和投影空间（投影矩阵），这些矩阵变换将3D世界的物体映射到2D屏幕上。</li></ul></li><li><p><strong>裁剪（Clipping）</strong>：</p><ul><li>裁剪是去除视锥体外部的图形部分，确保只有视野范围内的物体被进一步处理。</li><li>如果一个物体的部分在屏幕外，它将被裁剪掉，以减少计算量。</li></ul></li><li><p><strong>光栅化（Rasterization）</strong>：</p><ul><li>这个阶段将几何图形（通常是三角形）转换为像素或片段（fragments）。栅格化的目标是确定哪些像素被三角形覆盖，并为这些像素计算颜色、深度等信息。</li></ul><p>在游戏中，通常每个三角形都会生成多个片段，每个片段对应于屏幕上的一个像素。栅格化使用<strong>重心坐标</strong>来计算每个像素的颜色、深度、纹理映射等属性。</p></li><li><p><strong>片段着色（Fragment Shading）</strong>：</p><ul><li>对每个生成的片段应用着色算法，如光照、纹理映射、环境光、反射等，使得最终图像看起来更逼真。</li><li>这一阶段通常包括各种渲染技术，如<strong>Phong光照模型</strong>、<strong>纹理映射</strong>、<strong>法线贴图</strong>、<strong>环境光遮蔽</strong>（Ambient Occlusion）等。</li></ul></li><li><p><strong>混合与深度测试（Blending and Depth Testing）</strong>：</p><ul><li>在多个物体的像素相交时，进行深度测试以决定哪些物体位于前面。</li><li>混合是处理透明物体的技术，它确保透明物体在背后物体的像素上正确显示。</li></ul></li></ol><h3 id="游戏中的栅格化优化" tabindex="-1"><a class="header-anchor" href="#游戏中的栅格化优化"><span>游戏中的栅格化优化</span></a></h3><p>游戏中的栅格化通常需要高效和高帧率的渲染，特别是在复杂的场景或多人在线游戏中。以下是一些常见的优化技术：</p><ol><li><p><strong>视锥体裁剪（Frustum Culling）</strong>：</p><ul><li>通过视锥体裁剪剔除掉视野外的物体，减少需要处理的图形数量。视锥体是从相机视角出发的一种锥形区域，所有在视锥体内的物体才会被渲染。</li></ul></li><li><p><strong>水平细分（Level of Detail, LOD）</strong>：</p><ul><li>通过降低远离视点物体的多边形数来减少计算量。例如，远处的山脉可能用一个简单的网格表示，而近处的建筑则使用高细节模型。</li></ul></li><li><p><strong>多重采样抗锯齿（MSAA）</strong>：</p><ul><li>多重采样抗锯齿可以减少栅格化过程中出现的锯齿现象，尤其是在物体边缘。</li></ul></li><li><p><strong>分块光栅化（Tile-based Rasterization）</strong>：</p><ul><li>将渲染区域分成多个小的块进行光栅化，每个块内的像素一起计算，减少内存带宽的消耗。</li></ul></li><li><p><strong>延迟渲染（Deferred Rendering）</strong>：</p><ul><li>在延迟渲染中，首先将场景的几何信息（位置、法线、颜色、深度等）写入多个缓冲区（G-buffer），然后在光照阶段才进行像素的着色计算。这样可以减少不必要的计算，特别是在有大量光源的场景中。</li></ul></li></ol><h3 id="游戏中栅格化的数学原理" tabindex="-1"><a class="header-anchor" href="#游戏中栅格化的数学原理"><span>游戏中栅格化的数学原理</span></a></h3><ol><li><p><strong>重心坐标</strong>： 栅格化时，通过重心坐标来判断每个像素是否在三角形内部。重心坐标可以根据三角形顶点的位置计算出当前像素的相对位置。</p><p>对于一个三角形的三个顶点 (P_0(x_0, y_0)), (P_1(x_1, y_1)), 和 (P_2(x_2, y_2))，重心坐标的公式如下：</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>λ</mi><mn>0</mn></msub><mo>=</mo><mfrac><mrow><mo stretchy="false">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>−</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>−</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>y</mi><mo>−</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><mrow><mo stretchy="false">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>−</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>−</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>−</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>y</mi><mn>0</mn></msub><mo>−</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex"> \\lambda_0 = \\frac{(y_1 - y_2)(x - x_2) + (x_2 - x_1)(y - y_2)}{(y_1 - y_2)(x_0 - x_2) + (x_2 - x_1)(y_0 - y_2)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>λ</mi><mn>1</mn></msub><mo>=</mo><mfrac><mrow><mo stretchy="false">(</mo><msub><mi>y</mi><mn>2</mn></msub><mo>−</mo><msub><mi>y</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>−</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>y</mi><mo>−</mo><msub><mi>y</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><mrow><mo stretchy="false">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>−</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>−</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>−</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>y</mi><mn>0</mn></msub><mo>−</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex"> \\lambda_1 = \\frac{(y_2 - y_0)(x - x_2) + (x_0 - x_2)(y - y_0)}{(y_1 - y_2)(x_0 - x_2) + (x_2 - x_1)(y_0 - y_2)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>λ</mi><mn>2</mn></msub><mo>=</mo><mn>1</mn><mo>−</mo><msub><mi>λ</mi><mn>0</mn></msub><mo>−</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex"> \\lambda_2 = 1 - \\lambda_0 - \\lambda_1 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>如果这三个重心坐标 (0 \\leq \\lambda_0, \\lambda_1, \\lambda_2 \\leq 1)，则点 (P(x, y)) 在三角形内部或边界上。</p></li><li><p><strong>光栅化中的纹理映射</strong>： 在纹理映射过程中，栅格化不仅需要确定每个像素的颜色，还要根据片段的位置来计算其纹理坐标。这个过程通常使用<strong>双线性插值</strong>或者<strong>三线性插值</strong>来计算纹理坐标，并最终映射到纹理图像的像素值。</p></li></ol><h3 id="栅格化在游戏中的应用" tabindex="-1"><a class="header-anchor" href="#栅格化在游戏中的应用"><span>栅格化在游戏中的应用</span></a></h3><p>栅格化不仅是一个技术细节，它直接影响游戏的视觉效果和渲染效率。例如：</p><ul><li><strong>真实感渲染</strong>：通过精细的栅格化算法，游戏能够呈现出细腻的阴影、反射、折射、光照等效果，使得虚拟世界更加逼真。</li><li><strong>即时渲染与虚拟现实</strong>：在虚拟现实（VR）和增强现实（AR）等应用中，栅格化需要以非常高的帧率运行，以保证流畅的用户体验。</li><li><strong>粒子系统</strong>：游戏中的粒子效果（如烟雾、火焰、爆炸）也依赖于栅格化技术，将数千甚至数百万个小粒子高效地渲染成视觉效果。</li></ul><p>总结来说，栅格化在游戏中的核心作用是将复杂的3D场景转换为平面图像，涉及大量的数学运算和优化技术，是现代图形引擎不可或缺的部分。</p><h2 id="z-buffer算法" tabindex="-1"><a class="header-anchor" href="#z-buffer算法"><span>Z-buffer算法</span></a></h2><ul><li>Z-buffer算法通过在渲染过程中维护一个深度缓冲区来判断哪些像素应该显示出来。算法的核心思想是：对于每个渲染的像素，比较当前像素的深度值和深度缓冲区中对应像素的深度值，决定是否更新该像素的颜色。</li></ul><h3 id="算法步骤" tabindex="-1"><a class="header-anchor" href="#算法步骤"><span>算法步骤</span></a></h3><ol><li><p><strong>初始化</strong>：</p><ul><li>创建一个与屏幕分辨率相同大小的深度缓冲区（Z-Buffer），并将其初始化为最大深度值（通常是无穷大）。</li></ul></li><li><p><strong>光栅化</strong>：</p><ul><li>将场景中的所有物体进行光栅化，即将三维物体转换为二维像素。</li></ul></li><li><p><strong>深度测试</strong>：</p><ul><li>对于每个像素，计算其深度值（Z值），并与深度缓冲区中对应位置的深度值进行比较： <ul><li>如果新计算的深度值小于（即更靠近视点）当前深度缓冲区中的值，则更新深度缓冲区，并将该像素的颜色信息写入颜色缓冲区。</li><li>如果新计算的深度值大于或等于当前深度缓冲区中的值，则该像素被丢弃，因为它被其他物体遮挡。</li></ul></li></ul></li><li><p><strong>渲染</strong>：</p><ul><li>完成深度测试后，颜色缓冲区中保存了最终的像素颜色，显示在屏幕上。</li></ul></li></ol><h3 id="优点" tabindex="-1"><a class="header-anchor" href="#优点"><span>优点</span></a></h3><ul><li><strong>简单高效</strong>：深度缓冲区算法简单直观，易于实现和理解。</li><li><strong>解决循环依赖</strong>：可以处理画家算法无法解决的循环依赖问题。</li><li><strong>透明度支持</strong>：可以正确处理透明度和半透明物体。</li><li><strong>硬件加速</strong>：现代GPU提供了硬件级的深度缓冲区支持，极大地提高了渲染性能。</li></ul><h3 id="缺点" tabindex="-1"><a class="header-anchor" href="#缺点"><span>缺点</span></a></h3><ul><li><strong>内存消耗</strong>：需要额外的内存来存储深度缓冲区，特别是在高分辨率下。</li><li><strong>精度问题</strong>：在某些情况下，深度缓冲区的精度可能不足以区分非常接近的物体，导致Z-Fighting现象。</li><li><strong>性能</strong>：虽然硬件加速了深度测试，但对于非常复杂的场景，深度测试仍然可能成为性能瓶颈。</li></ul><h3 id="应用" tabindex="-1"><a class="header-anchor" href="#应用"><span>应用</span></a></h3><ul><li><strong>3D游戏</strong>：深度缓冲区是现代3D游戏引擎的核心技术，用于实时渲染复杂的三维场景。</li><li><strong>计算机图形学</strong>：在各种图形应用中，如CAD、动画、虚拟现实等，深度缓冲区用于解决深度排序问题。</li><li><strong>科学可视化</strong>：在医学成像、地震学等领域，用于渲染三维数据。</li></ul><h3 id="优化和扩展" tabindex="-1"><a class="header-anchor" href="#优化和扩展"><span>优化和扩展</span></a></h3><ul><li><strong>深度预处理</strong>：在渲染前进行深度预处理（如深度预渲染），可以减少后续渲染的计算量。</li><li><strong>深度精度优化</strong>：使用浮点数或更高精度的深度缓冲区来减少Z-Fighting现象。</li><li><strong>深度剔除</strong>：通过深度剔除技术，提前剔除不可见的物体，减少渲染负担。</li><li><strong>深度偏移（Depth Offset）</strong>：用于解决Z-Fighting问题，通过微小的深度偏移来区分非常接近的物体。</li></ul><p>深度缓冲区算法是现代图形渲染中的一个关键技术，它解决了画家算法的许多限制，提供了高效、准确的深度排序和遮挡处理方法。随着图形硬件的发展，深度缓冲区技术得到了广泛的应用和优化，使得复杂的三维场景能够以高帧率实时渲染。</p><h2 id="简单光照模型" tabindex="-1"><a class="header-anchor" href="#简单光照模型"><span>简单光照模型</span></a></h2><p>Blinn-Phong反射模型和兰伯特（Lambert）反射模型都是计算机图形学中用来模拟表面光照的模型，但它们在处理光照计算的方式和细节上有很大的不同。下面，我们将详细对比这两种模型。</p><h3 id="_1-兰伯特反射模型-lambertian-reflectance-model" tabindex="-1"><a class="header-anchor" href="#_1-兰伯特反射模型-lambertian-reflectance-model"><span>1. <strong>兰伯特反射模型（Lambertian Reflectance Model）</strong></span></a></h3><p>兰伯特模型是一种非常简单的漫反射光照模型，基于<strong>Lambert Cosine Law</strong>。它用于描述表面在均匀的光源照射下的反射行为，假设表面是<strong>理想的漫反射表面</strong>（即粗糙、无镜面反射的表面）。</p><h4 id="_1-1-兰伯特模型的特点" tabindex="-1"><a class="header-anchor" href="#_1-1-兰伯特模型的特点"><span>1.1 <strong>兰伯特模型的特点</strong></span></a></h4><ul><li><strong>漫反射</strong>：兰伯特模型仅考虑漫反射光照，不涉及镜面反射或高光反射。</li><li><strong>光照强度与法线夹角有关</strong>：兰伯特模型的核心是反射强度与光线方向与表面法线的夹角（( \\theta )）的余弦值成正比。公式如下：</li></ul><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>I</mi><mtext>diffuse</mtext></msub><mo>=</mo><msub><mi>k</mi><mi>d</mi></msub><mo>⋅</mo><mo stretchy="false">(</mo><mi>L</mi><mo>⋅</mo><mi>N</mi><mo stretchy="false">)</mo><mo>⋅</mo><msub><mi>L</mi><mtext>diffuse</mtext></msub></mrow><annotation encoding="application/x-tex"> I_{\\text{diffuse}} = k_d \\cdot (L \\cdot N) \\cdot L_{\\text{diffuse}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">diffuse</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">diffuse</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>其中：</p><ul><li>( k_d ) 是漫反射系数。</li><li>( L ) 是从光源到表面的方向向量。</li><li>( N ) 是表面法线向量。</li><li>( L_{\\text{diffuse}} ) 是光源的漫反射光强。</li><li>( (L \\cdot N) ) 表示光源方向和表面法线之间的点积，通常 ( \\cos(\\theta) )。</li></ul><p>兰伯特模型的光照强度与光线入射角度有关。当光线垂直于表面时，反射强度最大；当光线平行于表面时，反射强度为零。</p><h4 id="_1-2-兰伯特模型的局限性" tabindex="-1"><a class="header-anchor" href="#_1-2-兰伯特模型的局限性"><span>1.2 <strong>兰伯特模型的局限性</strong></span></a></h4><ul><li>只考虑漫反射，不涉及镜面反射。</li><li>不能模拟高光反射和物体的光滑表面。</li><li>假设表面是完全漫反射的，忽略了实际材料的复杂光照特性。</li></ul><h3 id="_2-blinn-phong反射模型" tabindex="-1"><a class="header-anchor" href="#_2-blinn-phong反射模型"><span>2. <strong>Blinn-Phong反射模型</strong></span></a></h3><p>Blinn-Phong反射模型是对Phong反射模型的优化，增加了对镜面反射的计算，并通过引入半程向量（( H )）来提高计算效率。Blinn-Phong模型在3D图形中被广泛应用，尤其是在需要高效计算的实时渲染场景中。</p><h4 id="_2-1-blinn-phong反射模型的特点" tabindex="-1"><a class="header-anchor" href="#_2-1-blinn-phong反射模型的特点"><span>2.1 <strong>Blinn-Phong反射模型的特点</strong></span></a></h4><p>Blinn-Phong反射模型考虑了三个主要的光照成分：</p><ul><li><strong>环境光（Ambient）</strong></li><li><strong>漫反射（Diffuse）</strong></li><li><strong>镜面反射（Specular）</strong></li></ul><p>具体来说，Blinn-Phong模型将反射分为以下几部分：</p><ul><li><strong>环境光</strong>：不受表面朝向影响，模拟全局环境光。</li><li><strong>漫反射</strong>：模拟表面粗糙的漫反射，使用光线方向和法线的点积来计算。</li><li><strong>镜面反射</strong>：模拟光线与表面交互后反射到观察者的高光部分，使用半程向量来代替Phong模型中的反射向量，从而提高计算效率。</li></ul><p>Blinn-Phong模型的光照计算公式如下：</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>I</mi><mo>=</mo><msub><mi>I</mi><mtext>ambient</mtext></msub><mo>+</mo><msub><mi>I</mi><mtext>diffuse</mtext></msub><mo>+</mo><msub><mi>I</mi><mtext>specular</mtext></msub></mrow><annotation encoding="application/x-tex"> I = I_{\\text{ambient}} + I_{\\text{diffuse}} + I_{\\text{specular}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ambient</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">diffuse</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">specular</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span></p><ul><li><p><strong>环境光</strong>：</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>I</mi><mtext>ambient</mtext></msub><mo>=</mo><msub><mi>k</mi><mi>a</mi></msub><mo>⋅</mo><msub><mi>L</mi><mtext>ambient</mtext></msub></mrow><annotation encoding="application/x-tex"> I_{\\text{ambient}} = k_a \\cdot L_{\\text{ambient}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ambient</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ambient</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p></li><li><p><strong>漫反射</strong>（与兰伯特模型类似）：</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>I</mi><mtext>diffuse</mtext></msub><mo>=</mo><msub><mi>k</mi><mi>d</mi></msub><mo>⋅</mo><mo stretchy="false">(</mo><mi>L</mi><mo>⋅</mo><mi>N</mi><mo stretchy="false">)</mo><mo>⋅</mo><msub><mi>L</mi><mtext>diffuse</mtext></msub></mrow><annotation encoding="application/x-tex"> I_{\\text{diffuse}} = k_d \\cdot (L \\cdot N) \\cdot L_{\\text{diffuse}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">diffuse</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">diffuse</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p></li><li><p><strong>镜面反射</strong>（使用半程向量 ( H )）：</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>I</mi><mtext>specular</mtext></msub><mo>=</mo><msub><mi>k</mi><mi>s</mi></msub><mo>⋅</mo><mo stretchy="false">(</mo><mi>N</mi><mo>⋅</mo><mi>H</mi><msup><mo stretchy="false">)</mo><mi>α</mi></msup><mo>⋅</mo><msub><mi>L</mi><mtext>specular</mtext></msub></mrow><annotation encoding="application/x-tex"> I_{\\text{specular}} = k_s \\cdot (N \\cdot H)^{\\alpha} \\cdot L_{\\text{specular}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">specular</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">specular</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span></p></li></ul><p>其中：</p><ul><li>( k_a, k_d, k_s ) 分别是环境光、漫反射和镜面反射的材质系数。</li><li>( N ) 是表面法线，( L ) 是光源方向，( H ) 是半程向量 ( H = \\frac{L + V}{|L + V|} )。</li><li>( V ) 是视点（或观察者）方向，( \\alpha ) 是高光指数，用来控制高光反射的锐度。</li></ul><h4 id="_2-2-blinn-phong的优势" tabindex="-1"><a class="header-anchor" href="#_2-2-blinn-phong的优势"><span>2.2 <strong>Blinn-Phong的优势</strong></span></a></h4><ul><li>相较于Phong模型，Blinn-Phong模型计算高光反射时更为高效，因为它使用了半程向量，避免了计算反射向量 ( R )。</li><li>通过引入镜面反射，Blinn-Phong能够模拟更真实的光照效果，特别是在光滑表面上。</li><li>在实时渲染中，它提供了更好的性能，尤其是在动态光源和相机变化的情况下。</li></ul><h4 id="_2-3-blinn-phong模型的局限性" tabindex="-1"><a class="header-anchor" href="#_2-3-blinn-phong模型的局限性"><span>2.3 <strong>Blinn-Phong模型的局限性</strong></span></a></h4><ul><li>Blinn-Phong仍然是一个简化的模型，无法完全模拟复杂的光照交互（例如散射、折射等）。</li><li>它依然没有考虑表面微结构的影响，因此在非常光滑或粗糙的表面上可能出现不真实的效果。</li><li>不如基于物理的渲染（PBR）模型精确。</li></ul><h3 id="_3-blinn-phong反射模型与兰伯特模型的对比" tabindex="-1"><a class="header-anchor" href="#_3-blinn-phong反射模型与兰伯特模型的对比"><span>3. <strong>Blinn-Phong反射模型与兰伯特模型的对比</strong></span></a></h3><table><thead><tr><th>特性</th><th>兰伯特反射模型（Lambertian）</th><th>Blinn-Phong反射模型</th></tr></thead><tbody><tr><td><strong>光照成分</strong></td><td>仅有漫反射（Diffuse）</td><td>环境光、漫反射和镜面反射（Specular）</td></tr><tr><td><strong>反射特性</strong></td><td>仅考虑漫反射，假设表面是完全粗糙的</td><td>考虑了镜面反射和高光反射，适合光滑表面</td></tr><tr><td><strong>计算复杂度</strong></td><td>较简单，计算仅涉及法线和光源方向的点积</td><td>计算稍复杂，需要半程向量和法线的点积计算</td></tr><tr><td><strong>应用场景</strong></td><td>适用于完全漫反射的表面，如粗糙材质</td><td>适用于具有高光反射的表面，如光滑材质和金属表面</td></tr><tr><td><strong>镜面反射</strong></td><td>无法模拟镜面反射（没有高光）</td><td>能够模拟镜面反射（通过半程向量来简化计算）</td></tr><tr><td><strong>表现的真实性</strong></td><td>模拟真实的漫反射，效果较简单</td><td>提供更真实的反射效果，尤其是在光滑表面上</td></tr></tbody></table><h3 id="_4-总结" tabindex="-1"><a class="header-anchor" href="#_4-总结"><span>4. <strong>总结</strong></span></a></h3><ul><li><strong>兰伯特模型</strong>非常适合用于模拟漫反射光照，特别是粗糙表面的光照，它计算简单，但只适用于没有镜面反射的场景。</li><li><strong>Blinn-Phong模型</strong>是对Phong模型的优化，考虑了镜面反射，因此能够模拟更加真实的光照效果，适用于光滑表面或具有镜面反射的材质。</li></ul><p>尽管Blinn-Phong比兰伯特模型更为复杂和真实，但它依然属于一种简化的光照模型，无法精确模拟复杂的光照交互，因此在现代图形学中，PBR（基于物理的渲染）模型逐渐成为更为常用的标准。</p><h2 id="半程向量" tabindex="-1"><a class="header-anchor" href="#半程向量"><span>半程向量</span></a></h2><p><strong>半程向量（Halfway Vector）</strong> 是计算镜面反射光照模型中的一个关键概念，尤其在 <strong>Blinn-Phong反射模型</strong> 中被广泛使用。它是光源方向向量 ( \\mathbf{L} ) 和观察者（视点）方向向量 ( \\mathbf{V} ) 的单位向量的<strong>平均值</strong>，即这两个向量的归一化和：</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="bold">H</mi><mo>=</mo><mfrac><mrow><mi mathvariant="bold">L</mi><mo>+</mo><mi mathvariant="bold">V</mi></mrow><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="bold">L</mi><mo>+</mo><mi mathvariant="bold">V</mi><mi mathvariant="normal">∣</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex"> \\mathbf{H} = \\frac{\\mathbf{L} + \\mathbf{V}}{|\\mathbf{L} + \\mathbf{V}|} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">H</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2991em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3631em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∣</span><span class="mord mathbf">L</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathbf" style="margin-right:0.01597em;">V</span><span class="mord">∣</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathbf">L</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><h3 id="_1-半程向量的直观理解" tabindex="-1"><a class="header-anchor" href="#_1-半程向量的直观理解"><span>1. <strong>半程向量的直观理解</strong></span></a></h3><p>在传统的 <strong>Phong反射模型</strong> 中，镜面反射（高光反射）是通过计算反射向量 ( \\mathbf{R} ) 和视点向量 ( \\mathbf{V} ) 的夹角来确定的，公式如下：</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="bold">R</mi><mo>=</mo><mn>2</mn><mo stretchy="false">(</mo><mi mathvariant="bold">N</mi><mo>⋅</mo><mi mathvariant="bold">L</mi><mo stretchy="false">)</mo><mi mathvariant="bold">N</mi><mo>−</mo><mi mathvariant="bold">L</mi></mrow><annotation encoding="application/x-tex"> \\mathbf{R} = 2 (\\mathbf{N} \\cdot \\mathbf{L}) \\mathbf{N} - \\mathbf{L} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mopen">(</span><span class="mord mathbf">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbf">L</span><span class="mclose">)</span><span class="mord mathbf">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">L</span></span></span></span></span></p><p>这里：</p><ul><li>( \\mathbf{N} ) 是表面法线向量，</li><li>( \\mathbf{L} ) 是光源方向向量，</li><li>( \\mathbf{R} ) 是反射向量。</li></ul><p>但在Blinn-Phong模型中，为了提高计算效率，我们引入了 <strong>半程向量</strong> ( \\mathbf{H} )，它是光源方向和观察者方向的单位向量的加权平均值。通过半程向量来计算镜面反射，不需要显式计算反射向量 ( \\mathbf{R} )，从而简化了计算过程。</p><h3 id="_2-为什么使用半程向量" tabindex="-1"><a class="header-anchor" href="#_2-为什么使用半程向量"><span>2. <strong>为什么使用半程向量？</strong></span></a></h3><p>计算反射向量 ( \\mathbf{R} ) 需要根据法线和光源的相对方向进行计算，这个过程相对较为复杂，尤其在实时渲染中，可能会影响渲染性能。而 <strong>半程向量</strong> ( \\mathbf{H} ) 的计算相对简单，因为它仅仅是光源方向和视线方向的加和，然后进行归一化。因此，Blinn-Phong模型通过使用半程向量来替代反射向量，提升了渲染效率。</p><p>此外，半程向量在视觉效果上也能提供平滑的过渡效果，因为它考虑了光源方向和视点方向的“平均”方向。</p><h3 id="_3-半程向量在blinn-phong模型中的作用" tabindex="-1"><a class="header-anchor" href="#_3-半程向量在blinn-phong模型中的作用"><span>3. <strong>半程向量在Blinn-Phong模型中的作用</strong></span></a></h3><p>在 <strong>Blinn-Phong反射模型</strong> 中，高光反射部分的计算公式使用半程向量而不是反射向量。Blinn-Phong的镜面反射项如下：</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>I</mi><mtext>specular</mtext></msub><mo>=</mo><msub><mi>k</mi><mi>s</mi></msub><mo>⋅</mo><mo stretchy="false">(</mo><mi mathvariant="bold">N</mi><mo>⋅</mo><mi mathvariant="bold">H</mi><msup><mo stretchy="false">)</mo><mi>α</mi></msup><mo>⋅</mo><msub><mi>L</mi><mtext>specular</mtext></msub></mrow><annotation encoding="application/x-tex"> I_{\\text{specular}} = k_s \\cdot (\\mathbf{N} \\cdot \\mathbf{H})^\\alpha \\cdot L_{\\text{specular}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">specular</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathbf">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbf">H</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">specular</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>其中：</p><ul><li>( k_s ) 是材质的镜面反射系数，</li><li>( \\mathbf{N} ) 是表面法线向量，</li><li>( \\mathbf{H} ) 是半程向量（( \\mathbf{H} = \\frac{\\mathbf{L} + \\mathbf{V}}{|\\mathbf{L} + \\mathbf{V}|} )），</li><li>( \\alpha ) 是光泽度或高光指数，控制高光的锐利程度。</li></ul><h4 id="_3-1-镜面反射的解释" tabindex="-1"><a class="header-anchor" href="#_3-1-镜面反射的解释"><span>3.1 <strong>镜面反射的解释</strong></span></a></h4><ul><li>( \\mathbf{N} \\cdot \\mathbf{H} ) 是表面法线和半程向量之间的点积，这个值控制了镜面反射的强度。因为半程向量代表了光源和观察者的“平均”方向，实际上模拟了光的反射和观测角度的相对关系。</li><li>( (\\mathbf{N} \\cdot \\mathbf{H})^\\alpha ) 表示高光反射的锐度，( \\alpha ) 控制了高光的分布范围。较大的 ( \\alpha ) 值会使高光反射更加集中，而较小的 ( \\alpha ) 值则会使高光反射更加扩散。</li></ul><h3 id="_4-半程向量的几何意义" tabindex="-1"><a class="header-anchor" href="#_4-半程向量的几何意义"><span>4. <strong>半程向量的几何意义</strong></span></a></h3><p>半程向量 ( \\mathbf{H} ) 的几何意义可以通过观察光源和观察者的相对位置来理解。它是光源和观察者之间的“平均”方向，因此，当 ( \\mathbf{H} ) 和表面法线 ( \\mathbf{N} ) 之间的夹角接近时，表明光源和观察者的方向都朝向表面，产生强烈的镜面反射效果。</p><ul><li>当光源和观察者的夹角很小（即它们几乎在同一方向上）时，镜面反射非常明显，( \\mathbf{N} \\cdot \\mathbf{H} ) 取值较大，反射高光强度较强。</li><li>当光源和观察者的夹角较大时，镜面反射较弱，反射高光强度较低。</li></ul><h3 id="_5-半程向量与传统反射向量的对比" tabindex="-1"><a class="header-anchor" href="#_5-半程向量与传统反射向量的对比"><span>5. <strong>半程向量与传统反射向量的对比</strong></span></a></h3><table><thead><tr><th>特性</th><th>反射向量（Phong）</th><th>半程向量（Blinn-Phong）</th></tr></thead><tbody><tr><td><strong>计算方法</strong></td><td>计算反射向量 ( \\mathbf{R} = 2(\\mathbf{N} \\cdot \\mathbf{L}) \\mathbf{N} - \\mathbf{L} )</td><td>计算半程向量 ( \\mathbf{H} = \\frac{\\mathbf{L} + \\mathbf{V}}{</td></tr><tr><td><strong>计算复杂度</strong></td><td>需要计算反射向量，涉及法线和光源方向</td><td>计算半程向量简单，只需计算光源方向和观察者方向的平均值</td></tr><tr><td><strong>效果</strong></td><td>更适合精准模拟反射光，适用于更复杂的表面</td><td>计算更高效，适合实时渲染，效果也较为平滑</td></tr><tr><td><strong>高光效果</strong></td><td>通过反射向量和观察者方向计算高光</td><td>通过半程向量和法线的点积计算高光，效果类似</td></tr></tbody></table><h3 id="_6-总结" tabindex="-1"><a class="header-anchor" href="#_6-总结"><span>6. <strong>总结</strong></span></a></h3><p>半程向量（( \\mathbf{H} )）是Blinn-Phong模型中用于计算镜面反射的关键向量，它是光源方向和观察者方向的平均值。通过引入半程向量，Blinn-Phong模型能够简化计算并提高渲染效率，同时在许多情况下能提供与Phong反射模型相似的高光反射效果。这个优化使得Blinn-Phong模型在实时渲染中成为非常流行的选择。</p><figure><img src="'+p+'" alt="alt text" tabindex="0" loading="lazy"><figcaption>alt text</figcaption></figure><h3 id="着色频率" tabindex="-1"><a class="header-anchor" href="#着色频率"><span>着色频率</span></a></h3><figure><img src="'+e+'" alt="alt text" tabindex="0" loading="lazy"><figcaption>alt text</figcaption></figure><p>下面是一个总结不同着色频率（如每像素着色、每顶点着色、每片段着色等）优缺点的表格：</p><table><thead><tr><th>着色频率</th><th>优点</th><th>缺点</th><th>适用场景</th></tr></thead><tbody><tr><td><strong>每像素着色（Per-Pixel Shading）</strong></td><td>- 提供最精细的光照和材质计算，适用于复杂的光照和细节处理<br>- 能够处理动态光源、阴影、高光等效果</td><td>- 计算开销较大，可能导致渲染性能下降<br>- 对硬件性能要求高，特别是高分辨率下</td><td>- 高质量图形渲染<br>- 电影级渲染<br>- 高质量实时渲染（如AAA游戏中的近景物体）</td></tr><tr><td><strong>每顶点着色（Per-Vertex Shading）</strong></td><td>- 计算开销较低，性能较好<br>- 适合简单的场景或大规模渲染<br>- 渲染速度快</td><td>- 无法精确描述每个像素的光照细节<br>- 无法处理复杂材质和纹理效果</td><td>- 简单几何图形渲染<br>- 用于背景、远景物体或低质量场景</td></tr><tr><td><strong>每片段着色（Per-Fragment Shading）</strong></td><td>- 细粒度的光照计算，适合处理复杂的纹理和材质<br>- 相对于每像素着色更高效</td><td>- 对性能要求较高，特别是在高分辨率时<br>- 可能需要额外的计算资源</td><td>- 实时渲染中的复杂光照处理（如实时光照与阴影）</td></tr><tr><td><strong>延迟着色（Deferred Shading）</strong></td><td>- 适合处理大量光源场景，减少光照计算<br>- 可以分离光照和几何计算，节省计算资源</td><td>- 内存消耗较大，需要储存额外的几何信息<br>- 对GPU要求高</td><td>- 大规模光源渲染（如多人在线游戏、场景复杂的实时渲染）</td></tr><tr><td><strong>每像素光照（Per-Pixel Lighting）</strong></td><td>- 对每个像素进行精确的光照计算，提供更真实的效果</td><td>- 计算复杂，性能开销较大<br>- 大量光源时性能瓶颈明显</td><td>- 需要精确光照效果的应用（如动态光照场景）</td></tr><tr><td><strong>光照贴图（Light Mapping）</strong></td><td>- 预计算光照，降低实时渲染时的光照计算开销<br>- 性能好，适用于大规模场景</td><td>- 无法处理动态光源<br>- 光照贴图需要占用大量内存</td><td>- 静态场景的高效渲染<br>- 需要静态光照效果的场景（如建筑物）</td></tr><tr><td><strong>基于物理的渲染（PBR）</strong></td><td>- 提供真实的材质和光照效果<br>- 适用于现代游戏和电影级渲染</td><td>- 计算复杂，性能要求较高<br>- 需要较高的纹理分辨率和复杂材质</td><td>- 需要物理真实感的渲染（如现代游戏、电影CG）</td></tr></tbody></table><h3 id="总结" tabindex="-1"><a class="header-anchor" href="#总结"><span>总结：</span></a></h3><ul><li><strong>每像素着色</strong> 提供最精细的光照和材质计算，但计算开销大，适用于高质量场景。（也不一定 对于现在顶点和平面越来越多）</li><li><strong>每顶点着色</strong> 性能较好，适合简单的几何渲染，但无法处理复杂的光照和细节。</li><li><strong>延迟着色</strong> 优化了多光源场景中的光照计算，但需要额外的内存和GPU资源。</li><li><strong>光照贴图</strong> 是一种预计算技术，减少了实时光照的计算，但不能处理动态光源。</li><li><strong>基于物理的渲染（PBR）</strong> 提供最真实的光照和材质效果，但对性能要求高，适用于现代高质量渲染。</li></ul><p>不同的着色频率和技术适合不同的应用场景，开发者可以根据项目的需求和硬件性能，选择适合的着色频率来平衡图像质量和渲染性能。</p><h2 id="图形管线" tabindex="-1"><a class="header-anchor" href="#图形管线"><span>图形管线</span></a></h2><p>从场景到一张图中间经历的过程</p><figure><img src="'+i+`" alt="alt text" tabindex="0" loading="lazy"><figcaption>alt text</figcaption></figure><h3 id="图形管线的各个阶段" tabindex="-1"><a class="header-anchor" href="#图形管线的各个阶段"><span>图形管线的各个阶段</span></a></h3><p>现代图形管线通常分为以下几个主要阶段，以下是一个常见的 <strong>渲染管线</strong> 流程：</p><h4 id="_1-顶点处理阶段-vertex-processing" tabindex="-1"><a class="header-anchor" href="#_1-顶点处理阶段-vertex-processing"><span>1. <strong>顶点处理阶段（Vertex Processing）</strong></span></a></h4><ul><li><strong>输入</strong>：原始三维模型数据（顶点坐标、法线、纹理坐标、颜色等）。</li><li><strong>处理</strong>：将顶点从模型空间变换到裁剪空间，并进行其他操作（如变换、照明、纹理坐标计算等）。</li><li><strong>主要操作</strong>： <ul><li><strong>顶点变换</strong>：使用变换矩阵（如世界矩阵、视图矩阵、投影矩阵）将顶点从模型空间转换到裁剪空间。</li><li><strong>光照计算</strong>：根据光源、观察者位置和表面法线等计算顶点的光照效果。</li><li><strong>顶点着色</strong>：计算每个顶点的颜色，通常包括基础的光照模型（如Phong、Blinn-Phong等）。</li></ul></li><li><strong>输出</strong>：每个顶点在裁剪空间中的位置和颜色信息。</li></ul><h4 id="_2-图元装配-primitive-assembly" tabindex="-1"><a class="header-anchor" href="#_2-图元装配-primitive-assembly"><span>2. <strong>图元装配（Primitive Assembly）</strong></span></a></h4><ul><li><strong>输入</strong>：顶点信息。</li><li><strong>处理</strong>：将多个顶点组合成图元（如点、线段、三角形等）。</li><li><strong>输出</strong>：图元（通常是三角形）供后续的光栅化阶段处理。</li></ul><h4 id="_3-裁剪-clipping" tabindex="-1"><a class="header-anchor" href="#_3-裁剪-clipping"><span>3. <strong>裁剪（Clipping）</strong></span></a></h4><ul><li><strong>输入</strong>：图元。</li><li><strong>处理</strong>：剔除视野之外的部分。裁剪会将那些超出视野或视锥体的图元剔除掉，以减少无效的计算。</li><li><strong>输出</strong>：经过裁剪后的图元，裁剪后的图元会进入光栅化阶段。</li></ul><h4 id="_4-光栅化阶段-rasterization" tabindex="-1"><a class="header-anchor" href="#_4-光栅化阶段-rasterization"><span>4. <strong>光栅化阶段（Rasterization）</strong></span></a></h4><ul><li><strong>输入</strong>：裁剪后的图元。</li><li><strong>处理</strong>：将图元转化为像素（片段），确定每个像素的颜色、深度值等信息。光栅化是将三维物体转化为二维图像的过程。</li><li><strong>主要操作</strong>： <ul><li><strong>插值计算</strong>：对顶点属性（如颜色、纹理坐标、法线、深度值）进行插值，以生成每个像素的属性。</li><li><strong>光栅化</strong>：将几何图元转化为屏幕上的像素，决定每个像素的颜色和深度。</li></ul></li><li><strong>输出</strong>：生成的片段（包括颜色、纹理、深度等）。</li></ul><h4 id="_5-片段处理阶段-fragment-processing" tabindex="-1"><a class="header-anchor" href="#_5-片段处理阶段-fragment-processing"><span>5. <strong>片段处理阶段（Fragment Processing）</strong></span></a></h4><ul><li><strong>输入</strong>：光栅化后的片段。</li><li><strong>处理</strong>：根据光照、材质、纹理等信息对每个片段进行详细着色和计算，确定最终像素的颜色。</li><li><strong>主要操作</strong>： <ul><li><strong>纹理映射</strong>：将纹理应用到片段上，计算片段的颜色。</li><li><strong>光照计算</strong>：进一步计算片段的光照效果，可能包含漫反射、镜面反射等。</li><li><strong>混合（Blending）</strong>：如果有透明物体，进行颜色混合计算。</li></ul></li><li><strong>输出</strong>：最终的片段数据（如颜色、深度、模板值等）。</li></ul><h4 id="_6-深度测试和模板测试-depth-and-stencil-testing" tabindex="-1"><a class="header-anchor" href="#_6-深度测试和模板测试-depth-and-stencil-testing"><span>6. <strong>深度测试和模板测试（Depth and Stencil Testing）</strong></span></a></h4><ul><li><strong>输入</strong>：经过片段处理后的数据（颜色、深度、模板等）。</li><li><strong>处理</strong>：在这个阶段，片段会与深度缓冲区（Z-buffer）进行比较，决定是否通过深度测试。模板测试用于进一步控制哪些片段可以绘制到帧缓冲区。</li><li><strong>输出</strong>：经过深度和模板测试的片段，合格的片段进入最后的帧缓冲阶段。</li></ul><h4 id="_7-帧缓冲合成-framebuffer-output" tabindex="-1"><a class="header-anchor" href="#_7-帧缓冲合成-framebuffer-output"><span>7. <strong>帧缓冲合成（Framebuffer Output）</strong></span></a></h4><ul><li><strong>输入</strong>：合格的片段数据。</li><li><strong>处理</strong>：将片段的颜色信息写入帧缓冲区中，形成最终的图像。</li><li><strong>输出</strong>：最终的图像结果。</li></ul><h3 id="图形管线流程图" tabindex="-1"><a class="header-anchor" href="#图形管线流程图"><span>图形管线流程图</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>输入数据（顶点、纹理等）</span></span>
<span class="line"><span>         ↓</span></span>
<span class="line"><span>   顶点处理阶段（Vertex Processing）</span></span>
<span class="line"><span>         ↓</span></span>
<span class="line"><span>   图元装配（Primitive Assembly）</span></span>
<span class="line"><span>         ↓</span></span>
<span class="line"><span>       裁剪（Clipping）</span></span>
<span class="line"><span>         ↓</span></span>
<span class="line"><span>    光栅化阶段（Rasterization）</span></span>
<span class="line"><span>         ↓</span></span>
<span class="line"><span>  片段处理阶段（Fragment Processing）</span></span>
<span class="line"><span>         ↓</span></span>
<span class="line"><span> 深度和模板测试（Depth and Stencil Testing）</span></span>
<span class="line"><span>         ↓</span></span>
<span class="line"><span>   帧缓冲合成（Framebuffer Output）</span></span>
<span class="line"><span>         ↓</span></span>
<span class="line"><span>    最终图像显示</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_8-管线优化技术" tabindex="-1"><a class="header-anchor" href="#_8-管线优化技术"><span>8. <strong>管线优化技术</strong></span></a></h3><ul><li><p><strong>延迟着色（Deferred Shading）</strong>：将光照计算推迟到所有几何体被渲染完成之后进行，从而避免每个光源都需要进行一次顶点着色的开销。适用于多光源场景。</p></li><li><p><strong>多重采样抗锯齿（MSAA）</strong>：在光栅化过程中，通过对每个像素进行多次采样来减少锯齿现象，从而提高图像质量。</p></li><li><p><strong>纹理映射（Texture Mapping）</strong>：通过在片段处理阶段对纹理进行映射，极大地提高渲染效率和视觉质量。</p></li><li><p><strong>光照贴图（Light Mapping）</strong>：对于静态光照场景，可以预先计算光照信息，减少实时光照计算的需求，从而提高渲染效率。</p></li><li><p><strong>级别细节（Level of Detail, LOD）</strong>：根据物体与摄像机的距离选择不同的模型细节级别，减少远处物体的细节，提升渲染性能。</p></li></ul><h3 id="_9-现代图形管线的扩展" tabindex="-1"><a class="header-anchor" href="#_9-现代图形管线的扩展"><span>9. <strong>现代图形管线的扩展</strong></span></a></h3><p>现代的图形管线通常包括更多的优化和扩展，尤其是在 <strong>物理基础渲染（PBR）</strong> 和 <strong>实时光照</strong> 等技术的支持下，整个渲染过程变得更加复杂和高效。例如：</p><ul><li><p><strong>光线追踪管线</strong>：为了模拟更加真实的光照效果，现代图形管线逐步集成了光线追踪技术，尤其是在反射、折射、阴影和全局光照的计算上。</p></li><li><p><strong>Compute Shaders</strong>：通过计算着色器来加速一些计算密集型的操作，如粒子系统、图像处理等。</p></li></ul><h3 id="_10-总结" tabindex="-1"><a class="header-anchor" href="#_10-总结"><span>10. <strong>总结</strong></span></a></h3><p>图形管线是计算机图形学中从输入数据到生成最终图像的一个复杂而有序的过程。每个阶段都包含了不同的图形计算任务，这些任务由 <strong>GPU</strong> 高效并行处理，从而实现实时渲染。随着图形技术的发展，现代图形管线已融入了许多先进的优化技术，如延迟着色、光照贴图、级别细节等，以提高图像质量和渲染性能。同时，随着 <strong>光线追踪</strong> 和 <strong>物理基础渲染（PBR）</strong> 等技术的引入，现代图形管线变得更加复杂和强大，能够生成更加逼真的渲染效果。</p><h2 id="纹理映射" tabindex="-1"><a class="header-anchor" href="#纹理映射"><span>纹理映射</span></a></h2>`,123)]))}const o=a(m,[["render",r],["__file","shading.html.vue"]]),d=JSON.parse('{"path":"/posts/%E6%B8%B8%E6%88%8F/games101/shading.html","title":"shading","lang":"zh-CN","frontmatter":{"title":"shading","category":["游戏","games101"],"date":"2024-12-23T21:34:32.000Z","headerDepth":2,"description":"栅格化 在游戏开发中，栅格化是图形渲染管线的一个核心部分，特别是在将3D世界中的几何数据转换为2D屏幕图像时。栅格化过程通常发生在渲染管线的后期，主要负责将由3D模型、纹理和光照计算得到的场景信息转化为2D图像。 游戏中的栅格化过程 在游戏中，栅格化涉及多个关键步骤，通常包括以下几个阶段： 几何处理（Geometry Processing）： 游戏中的...","head":[["meta",{"property":"og:url","content":"https://blog.vipfreevpn.top/posts/%E6%B8%B8%E6%88%8F/games101/shading.html"}],["meta",{"property":"og:site_name","content":"博客"}],["meta",{"property":"og:title","content":"shading"}],["meta",{"property":"og:description","content":"栅格化 在游戏开发中，栅格化是图形渲染管线的一个核心部分，特别是在将3D世界中的几何数据转换为2D屏幕图像时。栅格化过程通常发生在渲染管线的后期，主要负责将由3D模型、纹理和光照计算得到的场景信息转化为2D图像。 游戏中的栅格化过程 在游戏中，栅格化涉及多个关键步骤，通常包括以下几个阶段： 几何处理（Geometry Processing）： 游戏中的..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"article:published_time","content":"2024-12-23T21:34:32.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"shading\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-12-23T21:34:32.000Z\\",\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"HideOne\\",\\"url\\":\\"https://mister-hope.com\\"}]}"]]},"headers":[{"level":2,"title":"栅格化","slug":"栅格化","link":"#栅格化","children":[{"level":3,"title":"游戏中的栅格化过程","slug":"游戏中的栅格化过程","link":"#游戏中的栅格化过程","children":[]},{"level":3,"title":"游戏中的栅格化优化","slug":"游戏中的栅格化优化","link":"#游戏中的栅格化优化","children":[]},{"level":3,"title":"游戏中栅格化的数学原理","slug":"游戏中栅格化的数学原理","link":"#游戏中栅格化的数学原理","children":[]},{"level":3,"title":"栅格化在游戏中的应用","slug":"栅格化在游戏中的应用","link":"#栅格化在游戏中的应用","children":[]}]},{"level":2,"title":"Z-buffer算法","slug":"z-buffer算法","link":"#z-buffer算法","children":[{"level":3,"title":"算法步骤","slug":"算法步骤","link":"#算法步骤","children":[]},{"level":3,"title":"优点","slug":"优点","link":"#优点","children":[]},{"level":3,"title":"缺点","slug":"缺点","link":"#缺点","children":[]},{"level":3,"title":"应用","slug":"应用","link":"#应用","children":[]},{"level":3,"title":"优化和扩展","slug":"优化和扩展","link":"#优化和扩展","children":[]}]},{"level":2,"title":"简单光照模型","slug":"简单光照模型","link":"#简单光照模型","children":[{"level":3,"title":"1. 兰伯特反射模型（Lambertian Reflectance Model）","slug":"_1-兰伯特反射模型-lambertian-reflectance-model","link":"#_1-兰伯特反射模型-lambertian-reflectance-model","children":[{"level":4,"title":"1.1 兰伯特模型的特点","slug":"_1-1-兰伯特模型的特点","link":"#_1-1-兰伯特模型的特点","children":[]},{"level":4,"title":"1.2 兰伯特模型的局限性","slug":"_1-2-兰伯特模型的局限性","link":"#_1-2-兰伯特模型的局限性","children":[]}]},{"level":3,"title":"2. Blinn-Phong反射模型","slug":"_2-blinn-phong反射模型","link":"#_2-blinn-phong反射模型","children":[{"level":4,"title":"2.1 Blinn-Phong反射模型的特点","slug":"_2-1-blinn-phong反射模型的特点","link":"#_2-1-blinn-phong反射模型的特点","children":[]},{"level":4,"title":"2.2 Blinn-Phong的优势","slug":"_2-2-blinn-phong的优势","link":"#_2-2-blinn-phong的优势","children":[]},{"level":4,"title":"2.3 Blinn-Phong模型的局限性","slug":"_2-3-blinn-phong模型的局限性","link":"#_2-3-blinn-phong模型的局限性","children":[]}]},{"level":3,"title":"3. Blinn-Phong反射模型与兰伯特模型的对比","slug":"_3-blinn-phong反射模型与兰伯特模型的对比","link":"#_3-blinn-phong反射模型与兰伯特模型的对比","children":[]},{"level":3,"title":"4. 总结","slug":"_4-总结","link":"#_4-总结","children":[]}]},{"level":2,"title":"半程向量","slug":"半程向量","link":"#半程向量","children":[{"level":3,"title":"1. 半程向量的直观理解","slug":"_1-半程向量的直观理解","link":"#_1-半程向量的直观理解","children":[]},{"level":3,"title":"2. 为什么使用半程向量？","slug":"_2-为什么使用半程向量","link":"#_2-为什么使用半程向量","children":[]},{"level":3,"title":"3. 半程向量在Blinn-Phong模型中的作用","slug":"_3-半程向量在blinn-phong模型中的作用","link":"#_3-半程向量在blinn-phong模型中的作用","children":[{"level":4,"title":"3.1 镜面反射的解释","slug":"_3-1-镜面反射的解释","link":"#_3-1-镜面反射的解释","children":[]}]},{"level":3,"title":"4. 半程向量的几何意义","slug":"_4-半程向量的几何意义","link":"#_4-半程向量的几何意义","children":[]},{"level":3,"title":"5. 半程向量与传统反射向量的对比","slug":"_5-半程向量与传统反射向量的对比","link":"#_5-半程向量与传统反射向量的对比","children":[]},{"level":3,"title":"6. 总结","slug":"_6-总结","link":"#_6-总结","children":[]},{"level":3,"title":"着色频率","slug":"着色频率","link":"#着色频率","children":[]},{"level":3,"title":"总结：","slug":"总结","link":"#总结","children":[]}]},{"level":2,"title":"图形管线","slug":"图形管线","link":"#图形管线","children":[{"level":3,"title":"图形管线的各个阶段","slug":"图形管线的各个阶段","link":"#图形管线的各个阶段","children":[{"level":4,"title":"1. 顶点处理阶段（Vertex Processing）","slug":"_1-顶点处理阶段-vertex-processing","link":"#_1-顶点处理阶段-vertex-processing","children":[]},{"level":4,"title":"2. 图元装配（Primitive Assembly）","slug":"_2-图元装配-primitive-assembly","link":"#_2-图元装配-primitive-assembly","children":[]},{"level":4,"title":"3. 裁剪（Clipping）","slug":"_3-裁剪-clipping","link":"#_3-裁剪-clipping","children":[]},{"level":4,"title":"4. 光栅化阶段（Rasterization）","slug":"_4-光栅化阶段-rasterization","link":"#_4-光栅化阶段-rasterization","children":[]},{"level":4,"title":"5. 片段处理阶段（Fragment Processing）","slug":"_5-片段处理阶段-fragment-processing","link":"#_5-片段处理阶段-fragment-processing","children":[]},{"level":4,"title":"6. 深度测试和模板测试（Depth and Stencil Testing）","slug":"_6-深度测试和模板测试-depth-and-stencil-testing","link":"#_6-深度测试和模板测试-depth-and-stencil-testing","children":[]},{"level":4,"title":"7. 帧缓冲合成（Framebuffer Output）","slug":"_7-帧缓冲合成-framebuffer-output","link":"#_7-帧缓冲合成-framebuffer-output","children":[]}]},{"level":3,"title":"图形管线流程图","slug":"图形管线流程图","link":"#图形管线流程图","children":[]},{"level":3,"title":"8. 管线优化技术","slug":"_8-管线优化技术","link":"#_8-管线优化技术","children":[]},{"level":3,"title":"9. 现代图形管线的扩展","slug":"_9-现代图形管线的扩展","link":"#_9-现代图形管线的扩展","children":[]},{"level":3,"title":"10. 总结","slug":"_10-总结","link":"#_10-总结","children":[]}]},{"level":2,"title":"纹理映射","slug":"纹理映射","link":"#纹理映射","children":[]}],"git":{"createdTime":null,"updatedTime":null,"contributors":[]},"readingTime":{"minutes":24.54,"words":7363},"filePathRelative":"posts/游戏/games101/shading.md","localizedDate":"2024年12月24日","excerpt":"<h2>栅格化</h2>\\n<p>在游戏开发中，栅格化是图形渲染管线的一个核心部分，特别是在将3D世界中的几何数据转换为2D屏幕图像时。栅格化过程通常发生在渲染管线的后期，主要负责将由3D模型、纹理和光照计算得到的场景信息转化为2D图像。</p>\\n<h3>游戏中的栅格化过程</h3>\\n<p>在游戏中，栅格化涉及多个关键步骤，通常包括以下几个阶段：</p>\\n<ol>\\n<li>\\n<p><strong>几何处理（Geometry Processing）</strong>：</p>\\n<ul>\\n<li>游戏中的三维模型（如人物、建筑、道具等）通过顶点坐标、法线、纹理坐标等信息进行处理。</li>\\n<li>每个模型的顶点在3D空间中被转换到相机视角（视图矩阵）和投影空间（投影矩阵），这些矩阵变换将3D世界的物体映射到2D屏幕上。</li>\\n</ul>\\n</li>\\n<li>\\n<p><strong>裁剪（Clipping）</strong>：</p>\\n<ul>\\n<li>裁剪是去除视锥体外部的图形部分，确保只有视野范围内的物体被进一步处理。</li>\\n<li>如果一个物体的部分在屏幕外，它将被裁剪掉，以减少计算量。</li>\\n</ul>\\n</li>\\n<li>\\n<p><strong>光栅化（Rasterization）</strong>：</p>\\n<ul>\\n<li>这个阶段将几何图形（通常是三角形）转换为像素或片段（fragments）。栅格化的目标是确定哪些像素被三角形覆盖，并为这些像素计算颜色、深度等信息。</li>\\n</ul>\\n<p>在游戏中，通常每个三角形都会生成多个片段，每个片段对应于屏幕上的一个像素。栅格化使用<strong>重心坐标</strong>来计算每个像素的颜色、深度、纹理映射等属性。</p>\\n</li>\\n<li>\\n<p><strong>片段着色（Fragment Shading）</strong>：</p>\\n<ul>\\n<li>对每个生成的片段应用着色算法，如光照、纹理映射、环境光、反射等，使得最终图像看起来更逼真。</li>\\n<li>这一阶段通常包括各种渲染技术，如<strong>Phong光照模型</strong>、<strong>纹理映射</strong>、<strong>法线贴图</strong>、<strong>环境光遮蔽</strong>（Ambient Occlusion）等。</li>\\n</ul>\\n</li>\\n<li>\\n<p><strong>混合与深度测试（Blending and Depth Testing）</strong>：</p>\\n<ul>\\n<li>在多个物体的像素相交时，进行深度测试以决定哪些物体位于前面。</li>\\n<li>混合是处理透明物体的技术，它确保透明物体在背后物体的像素上正确显示。</li>\\n</ul>\\n</li>\\n</ol>","autoDesc":true}');export{o as comp,d as data};
